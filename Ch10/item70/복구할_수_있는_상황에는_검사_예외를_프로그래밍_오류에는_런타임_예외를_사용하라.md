# Item 70. 복구할 수 있는 상황에는 검사 예외를, 프로그래밍 오류에는 런타임 예외를 사용하라

### 문제 상황을 알리는 타입

Java에서는 문제 상황을 알리는 타입(throwable)으로 error, checked exception, unchecked exception(runtime exception)로 세 가지를 제공하고 있다.

![image](throwable.png)

<br/>

### 호출하는 쪽에서 복구하리라 여겨지는 상황이라면 `검사 예외(Checked Exceptions)`를 사용하라

예시)

```java
public class BankAccount {
    private double balance;

    public BankAccount(double initialBalance) {
        this.balance = initialBalance;
    }

    /**
     * Withdraws the given amount from the account.
     *
     * @param amount The amount to withdraw
     * @throws InsufficientFundsException if the account does not have enough
     *                                    balance
     */
    public void withdraw(double amount) throws InsufficientFundsException {
        if (amount > balance) {
            throw new InsufficientFundsException("Insufficient funds. You have only: " + balance);
        }
        balance -= amount;
    }

    public double getBalance() {
        return balance;
    }

    public static void main(String[] args) {
        BankAccount account = new BankAccount(100.0);

        try {
            account.withdraw(150.0);
        } catch (InsufficientFundsException e) {
            System.out.println(e.getMessage());
            // Here, the caller can recover, maybe by prompting the user for a different
            // amount
        }
    }
}

class InsufficientFundsException extends Exception {
    public InsufficientFundsException(String message) {
        super(message);
    }
}
```

```bash
java 70_CheckedException.java
Insufficient funds. You have only: 100.0
```

-   호출하는 쪽에서 복구하리라 여겨지는 상황이라면 검사 예외 사용
-   검사 예외를 던지면 호출자가 그 예외를 catch로 잡아 처리하거나 더 바깥으로 전파하도록 강제할 수 있음
-   검사 예외를 던지는 메서드는 모두 정상적으로 수행되어 호출된다고 가정
-   검사 예외를 던지는 메서드는 반드시 그 상태를 변경하지 않는다고 가정
-   검사 예외를 던지는 메서드는 호출된다면 그 예외를 정확히 문서화해야 함
-   검사 예외를 던지는 메서드는 스레드의 안전성을 보장하지 않는다고 가정
-   검사 예외를 던지는 메서드는 성능이 일반적으로 느리다고 가정
-   검사 예외를 던지는 메서드는 API를 더 어렵게 만든다고 가정
-   검사 예외를 던지는 메서드는 스트림 안에서 직접 사용할 수 없다고 가정
-   검사 예외를 던지는 메서드는 Optional을 반환할 수 없다고 가정
-   검사 예외를 던지는 메서드는 메서드 참조를 사용할 수 없다고 가정
-   검사 예외를 던지는 메서드는 람다를 사용할 수 없다고 가정
-   검사 예외를 던지는 메서드는 반복을 사용할 수 없다고 가정
-   ...

<br/>

### 프로그래밍 오류를 나타낼 때는 `런타임 예외(Runtime Exceptions)`를 사용하라

예시)

```java
public class UserAgeValidator {
    private int age;

    public UserAgeValidator(int age) {
        setAge(age);
    }

    /**
     * Sets the age, ensuring that it is a valid positive number.
     *
     * @param age Age of the user
     * @throws IllegalArgumentException if the provided age is not a positive number
     */
    public void setAge(int age) {
        if (age <= 0) {
            throw new IllegalArgumentException("Age must be a positive number.");
        }
        this.age = age;
    }

    public int getAge() {
        return age;
    }

    public static void main(String[] args) {
        try {
            UserAgeValidator validator = new UserAgeValidator(-5);
        } catch (IllegalArgumentException e) {
            System.out.println(e.getMessage());
        }
    }
}
```

```bash
java 70-2_RuntimeException.java
Age must be a positive number.
```

-   위의 코드를 실행하면, 나이가 음수로 설정되어 있기 때문에 IllegalArgumentException이 발생합니다.
-   이 예외 유형은 런타임 예외입니다.
-   이것은 프로그래밍 오류 또는 잘못된 인수를 나타내기 때문에, 메서드 시그니처에 throws 절로 선언할 필요가 없습니다.
